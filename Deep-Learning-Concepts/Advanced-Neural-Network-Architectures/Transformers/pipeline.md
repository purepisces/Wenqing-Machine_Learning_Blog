# Token â†’ Embedding â†’ Attention è§£é‡Šæ–‡æ¡£

## 1ï¸âƒ£ æ–‡æœ¬ â†’ Token

è¾“å…¥æ–‡æœ¬ï¼š

    "Hello world !"

ç»è¿‡ tokenizer å˜æˆ token idsï¼ˆç¤ºä¾‹ï¼‰ï¼š

    [101, 205, 33]

------------------------------------------------------------------------

## 2ï¸âƒ£ Token ID â†’ Embeddingï¼ˆæŸ¥è¡¨ï¼‰

æ¨¡å‹å†…éƒ¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„çŸ©é˜µï¼š

## ğŸ“¦ Embedding Matrix

å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªï¼š

> è¯å…¸ â†’ å‘é‡ çš„æ˜ å°„è¡¨

ä¾‹å¦‚ï¼ˆç¤ºæ„ï¼‰ï¼š

  Token   å‘é‡
  ------- ------
  Hello   e1
  world   e2
  !       e3

å½“æ¨¡å‹çœ‹åˆ° token id æ—¶ï¼Œå®ƒä¸ä¼š"è®¡ç®—" embeddingã€‚

å®ƒæ˜¯ï¼š

> ç›´æ¥æŸ¥è¡¨ï¼ˆlookupï¼‰

å°±åƒæŸ¥å­—å…¸ä¸€æ ·ã€‚

------------------------------------------------------------------------

## ç¤ºä¾‹å‘é‡ï¼ˆä»…ä¸ºæ¼”ç¤ºï¼‰

    Hello â†’ e1 = [0.2, 0.5]
    world â†’ e2 = [0.8, 0.1]
    !     â†’ e3 = [0.4, 0.9]

âš ï¸ çœŸå®æ¨¡å‹ä¸­å‘é‡ç»´åº¦å¯èƒ½æ˜¯ 4096 ç»´æˆ–æ›´é«˜ã€‚

------------------------------------------------------------------------

## 3ï¸âƒ£ å¾—åˆ°çš„å¼ é‡å½¢çŠ¶

å‡è®¾ï¼š

-   BS = 1
-   SS = 3
-   hidden_dim = 4096ï¼ˆç¤ºä¾‹ï¼‰

é‚£ä¹ˆ embedding ä¹‹åçš„å½¢çŠ¶æ˜¯ï¼š

    [BS, SS, hidden_dim]

ä¾‹å¦‚ï¼š

    [1, 3, 4096]

------------------------------------------------------------------------

## 4ï¸âƒ£ æ¥ä¸‹æ¥å‘ç”Ÿä»€ä¹ˆï¼Ÿ

    e1, e2, e3
        â†“
    ç”Ÿæˆ Q, K, V
        â†“
    Self-Attention
        â†“
    å¾—åˆ° h1, h2, h3

ä¹Ÿå°±æ˜¯è¯´ï¼š

> Token å…ˆå˜æˆ embedding å‘é‡\
> å†è¿›å…¥ attention è®¡ç®—

------------------------------------------------------------------------

## ğŸ¯ æ€»ç»“

å®Œæ•´æµç¨‹ï¼š

    æ–‡æœ¬
      â†“
    Token IDs
      â†“
    Embedding Lookupï¼ˆæŸ¥è¡¨ï¼‰
      â†“
    Q / K / V
      â†“
    Attention
      â†“
    è¾“å‡ºéšè—å‘é‡
